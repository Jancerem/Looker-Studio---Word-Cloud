<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Word Cloud UANL - Profesional</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="d3.layout.cloud.min.js"></script> <!-- Archivo local en tu repo -->
<style>
  body {
    margin: 0;
    background: #1a1a1a;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: Arial, sans-serif;
  }
  svg {
    width: 800px;
    height: 600px;
  }
</style>
</head>
<body>
<svg id="wordcloud"></svg>

<script>
const SHEET_JSON_URL = "https://script.google.com/macros/s/AKfycbzKoU7hWOvbV_xF8_gO6ayMgbKP1uzlg0SYd7R-WCmGiGFOAXlhYGroc6FaxYxIlOG7/exec";

fetch(SHEET_JSON_URL)
  .then(response => response.json())
  .then(data => {
    const maxFreq = d3.max(data, d => d[1]);

    const words = data.map(d => ({
      text: d[0],
      size: 20 + (d[1] / maxFreq) * 80 // tamaño mínimo 20px, máximo 100px
    }));

    const layout = d3.layout.cloud()
      .size([800, 600])
      .words(words)
      .padding(5)
      .rotate(() => (Math.random() < 0.1 ? 90 : 0)) // pocas rotaciones
      .font('Arial')
      .fontSize(d => d.size)
      .on('end', draw);

    layout.start();

    function draw(words) {
      d3.select("#wordcloud")
        .attr("width", 800)
        .attr("height", 600)
        .append("g")
        .attr("transform", "translate(400,300)") // centro del canvas
        .selectAll("text")
        .data(words)
        .enter().append("text")
        .style("font-size", d => d.size + "px")
        .style("fill", d => d3.interpolateTurbo(d.size / 100)) // gradiente de color
        .attr("text-anchor", "middle")
        .attr("transform", d => "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")")
        .text(d => d.text);
    }
  })
  .catch(err => console.error("Error cargando datos:", err));
</script>
</body>
</html>
